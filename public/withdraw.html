<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Withdrawal Interface</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --primary-green: #301ddd;
            --blue-link: #4a90e2;
            --text-gray: #8e8e93;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .phone-container {
            width: 100%;
            max-width: 375px;
            background: white;
            min-height: 90vh;
            padding: 20px;
            border-radius: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Header Icons */
        .top-nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        .nav-circle {
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .nav-circle:hover {
            background: #e5e5e5;
        }
        .nav-icon {
            font-size: 18px;
            color: #555;
        }

        h3 {
            color: var(--text-gray);
            font-size: 16px;
            font-weight: 400;
            margin-bottom: 15px;
        }

        /* Payment Methods */
        .method-row {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        .method-btn {
            background: white;
            border: 1px solid #eee;
            padding: 12px 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            white-space: nowrap;
            transition: all 0.2s;
        }
        .method-btn:hover {
            border-color: #ddd;
        }
        .method-btn.active {
            border-color: var(--primary-green);
            box-shadow: 0 0 0 1px var(--primary-green);
            background-color: #f8f9ff;
        }
        .method-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }
        .method-icon.bank { color: #2e6bdc; }
        .method-icon.usdt { color: #26a17b; }
        .method-icon.paypal { color: #003087; }

        /* Wallet Cards */
        .wallet-row {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        .wallet-option {
            flex: 1;
            position: relative;
        }
        .wallet-option input {
            position: absolute;
            opacity: 0;
        }
        .wallet-card {
            border: 1px solid #f0f0f0;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            background: #fafafa;
            transition: all 0.2s;
        }
        .wallet-card:hover {
            background: #f5f5f5;
            border-color: #ddd;
        }
        .wallet-option input:checked + .wallet-card {
            background: white;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 1px var(--primary-green);
        }
        .radio-circle {
            width: 18px;
            height: 18px;
            border: 2px solid #ccc;
            border-radius: 50%;
            transition: all 0.2s;
        }
        .wallet-option input:checked + .wallet-card .radio-circle {
            border-color: var(--primary-green);
            background: radial-gradient(var(--primary-green) 50%, transparent 50%);
        }
        .wallet-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }
        .commission-icon { color: #4a6bdc; }
        .sweat-icon { color: #ff6b35; }
        .wallet-label { font-size: 14px; font-weight: bold; color: #555; }
        .wallet-amt { font-size: 12px; color: var(--text-gray); display: block; }

        /* Input Section */
        .amount-box {
            background: #f1f3f2;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            transition: all 0.2s;
        }
        .amount-box:focus-within {
            background: #e9eceb;
        }
        .amount-box input {
            background: transparent;
            border: none;
            font-size: 32px;
            font-weight: bold;
            width: 100%;
            outline: none;
            color: #333;
        }
        .amount-box input::placeholder {
            color: #aaa;
        }
        .min-txt { color: var(--text-gray); font-size: 12px; margin-top: 5px; }

        /* Main Buttons */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 12px;
            border: none;
            transition: all 0.2s;
        }
        .btn-withdraw { 
            background: var(--primary-green); 
            color: white; 
        }
        .btn-withdraw:hover {
            background: #2a18c4;
        }
        .btn-history { 
            background: transparent; 
            border: 1px solid var(--blue-link); 
            color: var(--blue-link); 
        }
        .btn-history:hover {
            background: #f0f7ff;
        }

        /* Modals */
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .modal {
            background: white;
            width: 85%;
            max-width: 320px;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            animation: modalAppear 0.3s ease-out;
        }
        @keyframes modalAppear {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal h2 { margin-top: 0; font-size: 18px; color: #333; }
        .confirm-details { 
            text-align: left; 
            background: #f9f9f9; 
            padding: 15px; 
            border-radius: 10px; 
            margin: 15px 0; 
        }
        .confirm-details p {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
        }
        .confirm-details strong {
            color: #666;
        }
        .modal-btns { display: flex; gap: 10px; }
        .btn-sm { 
            flex: 1; 
            padding: 10px; 
            border-radius: 8px; 
            border: none; 
            cursor: pointer; 
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-cancel {
            background: #eee;
            color: #666;
        }
        .btn-cancel:hover {
            background: #e0e0e0;
        }
        .btn-confirm {
            background: var(--primary-green);
            color: white;
        }
        .btn-confirm:hover {
            background: #2a18c4;
        }

        /* History */
        #historySection { 
            margin-top: 20px; 
            border-top: 1px solid #eee; 
            padding-top: 15px; 
            display: none; 
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .history-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            padding: 12px 10px; 
            border-bottom: 1px solid #f9f9f9; 
            transition: background-color 0.2s;
        }
        .history-item:hover {
            background-color: #fafafa;
        }
        .status-pending { 
            color: #ff9500; 
            font-weight: bold; 
            font-size: 13px;
            padding: 4px 8px;
            background: #fff8e6;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .status-pending:hover {
            background: #ffedc2;
        }
        .status-approved { 
            color: #34c759; 
            font-weight: bold;
            font-size: 13px;
            padding: 4px 8px;
            background: #e9f9ed;
            border-radius: 12px;
        }

        /* Success icon in receipt */
        .success-icon {
            font-size: 50px;
            color: #34c759;
            margin-bottom: 10px;
        }

        /* Amount currency symbol */
        .currency-symbol {
            position: absolute;
            font-size: 32px;
            font-weight: bold;
            color: #333;
            left: 25px;
            top: 25px;
        }
        .amount-input-container {
            position: relative;
        }
        .amount-input-container input {
            padding-left: 30px;
        }
    </style>
    <script src="js/auth-guard.js"></script>
</head>
<body>

<div class="phone-container">
    <div class="top-nav">
        <a href="dashboard.html" class="nav-circle" title="Back to Dashboard">
            <i class="fas fa-arrow-left nav-icon"></i>
        </a>
        <div class="nav-circle" title="Menu">
            <i class="fas fa-bars nav-icon"></i>
        </div>
    </div>

    <h3>Select Payment Method</h3>
    <div class="method-row">
        <div class="method-btn active" onclick="setMethod(this, 'Direct Bank')">
            <i class="fas fa-university method-icon bank"></i>
            <span>Direct Bank</span>
        </div>
        <div class="method-btn" onclick="setMethod(this, 'USDT')">
            <i class="fas fa-coins method-icon usdt"></i>
            <span>USDT</span>
        </div>
        <div class="method-btn" onclick="setMethod(this, 'PayPal')">
            <i class="fab fa-paypal method-icon paypal"></i>
            <span>PayPal</span>
        </div>
    </div>

    <h3>Select a Wallet</h3>
    <div class="wallet-row">
        <label class="wallet-option">
            <input type="radio" name="wallet" value="Commission" checked>
            <div class="wallet-card">
                <div class="radio-circle"></div>
                <i class="fas fa-wallet wallet-icon commission-icon"></i>
                <div>
                    <span class="wallet-label">Commission</span>
                    <span class="wallet-amt" id="commissionBalance">...</span>
                </div>
            </div>
        </label>
        <label class="wallet-option">
            <input type="radio" name="wallet" value="Tasks earnings">
            <div class="wallet-card">
                <div class="radio-circle"></div>
                <i class="fas fa-fire wallet-icon sweat-icon"></i>
                <div>
                    <span class="wallet-label">Tasks earnings</span>
                    <span class="wallet-amt" id="tasksBalance">...</span>
                </div>
            </div>
        </label>
    </div>

    <div class="amount-box">
        <div class="amount-input-container">
            <span id="currencySymbol" class="currency-symbol">₦</span>
            <input type="number" id="amtInput" placeholder="0.00" min="0" step="0.01">
        </div>
        <div class="min-txt" id="minWithdrawalDisplay">Minimum withdrawal: ₦1,000.00</div>
    </div>

    <button class="btn btn-withdraw" onclick="openConfirm()">
        <i class="fas fa-money-bill-wave" style="margin-right: 8px;"></i>Withdraw Funds
    </button>
    <button class="btn btn-history" onclick="toggleHistory()">
        <i class="fas fa-history" style="margin-right: 8px;"></i>Withdrawal History
    </button>

    <div id="historySection">
        <h3 style="color:#333; margin-top: 0;">
            <i class="fas fa-clock" style="margin-right: 8px;"></i>Transaction History
        </h3>
        <div id="historyList">
        </div>
    </div>
</div>

<div id="confirmModal" class="overlay">
    <div class="modal">
        <h2><i class="fas fa-clipboard-check" style="color: var(--primary-green); margin-right: 8px;"></i>Confirm Details</h2>
        <div class="confirm-details">
            <p><strong>Method:</strong> <span id="dispMethod"></span></p>
            <p><strong>Wallet:</strong> <span id="dispWallet"></span></p>
            <p><strong>Amount:</strong> <span id="dispAmt"></span></p>
            <p><strong>Fee:</strong> <span id="dispFee">₦0.00</span></p>
            <p><strong>Total:</strong> <span id="dispTotal"></span></p>
        </div>
        <div class="modal-btns">
            <button class="btn-sm btn-cancel" onclick="closeModals()">Cancel</button>
            <button class="btn-sm btn-confirm" onclick="showReceipt()">Confirm</button>
        </div>
    </div>
</div>

<div id="receiptModal" class="overlay">
    <div class="modal">
        <div class="success-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <h2>Transaction Successful</h2>
        <p>Your withdrawal request is being processed.</p>
        <hr style="border: none; border-top: 1px solid #eee; margin: 20px 0;">
        <div style="text-align: left; background: #f9f9f9; padding: 15px; border-radius: 10px;">
            <p><strong>Transaction ID:</strong> <span id="transId">TX-789012</span></p>
            <p><strong>Amount:</strong> <span id="recAmt"></span></p>
            <p><strong>Date:</strong> <span id="transDate"></span></p>
            <p><strong>Status:</strong> <span style="color: #ff9500; font-weight: bold;">Pending</span></p>
        </div>
        <button class="btn-sm" style="background:#eee; width:100%; margin-top: 20px;" onclick="finishTransaction()">
            <i class="fas fa-times" style="margin-right: 8px;"></i>Close
        </button>
    </div>
</div>

<script>
    let currentMethod = "Direct Bank";
    
    document.addEventListener('DOMContentLoaded', function() {
        addToHistory(5000, "Direct Bank", true);
        addToHistory(12000, "USDT", true);
        addToHistory(8000, "PayPal", false);
        
        document.getElementById('transDate').textContent = new Date().toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
    });

    function setMethod(el, val) {
        document.querySelectorAll('.method-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        currentMethod = val;
    }

    function openConfirm() {
        const amt = document.getElementById('amtInput').value;
        const wallet = document.querySelector('input[name="wallet"]:checked').value;
        
        if(!amt || amt <= 0) {
            alert("Please enter a valid amount");
            document.getElementById('amtInput').focus();
            return;
        }
        
        if(amt < 1000) {
            alert("Minimum withdrawal amount is ₦1,000.00");
            return;
        }

        document.getElementById('dispMethod').innerText = currentMethod;
        document.getElementById('dispWallet').innerText = wallet;
        document.getElementById('dispAmt').innerText = '₦' + parseFloat(amt).toLocaleString('en-US', {minimumFractionDigits: 2});
        
        const fee = amt * 0.02;
        const total = amt - fee;
        document.getElementById('dispFee').innerText = '₦' + fee.toLocaleString('en-US', {minimumFractionDigits: 2});
        document.getElementById('dispTotal').innerText = '₦' + total.toLocaleString('en-US', {minimumFractionDigits: 2});
        
        document.getElementById('confirmModal').style.display = 'flex';
    }

    function closeModals() {
        document.querySelectorAll('.overlay').forEach(m => m.style.display = 'none');
    }

    function showReceipt() {
        const amt = document.getElementById('amtInput').value;
        document.getElementById('confirmModal').style.display = 'none';
        document.getElementById('recAmt').innerText = '₦' + parseFloat(amt).toLocaleString('en-US', {minimumFractionDigits: 2});
        document.getElementById('receiptModal').style.display = 'flex';
        
        document.getElementById('transId').textContent = 'TX-' + Math.floor(100000 + Math.random() * 900000);
        
        addToHistory(amt, currentMethod, false);
    }

    function addToHistory(amt, method, isApproved) {
        const list = document.getElementById('historyList');
        const item = document.createElement('div');
        item.className = 'history-item';
        
        const now = new Date();
        const timeStr = now.toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'});
        const dateStr = now.toLocaleDateString('en-US', {month: 'short', day: 'numeric'});
        
        item.innerHTML = `
            <div>
                <div style="font-weight:bold; color: #333;">₦${parseFloat(amt).toLocaleString('en-US', {minimumFractionDigits: 2})}</div>
                <div style="font-size:11px; color:#888">${method} • ${dateStr}, ${timeStr}</div>
            </div>
            <div class="${isApproved ? 'status-approved' : 'status-pending'}" onclick="${isApproved ? '' : 'approve(this)'}">
                ${isApproved ? 'Approved' : 'Pending'}
            </div>
        `;
        list.prepend(item);
    }

    function approve(el) {
        el.innerText = "Approved";
        el.className = "status-approved";
        el.onclick = null;
        
        // Show a brief confirmation
        const originalText = el.innerHTML;
        el.innerHTML = '<i class="fas fa-check"></i> Approved';
        setTimeout(() => {
            el.innerHTML = originalText;
        }, 1000);
    }

    function toggleHistory() {
        const sec = document.getElementById('historySection');
        if (sec.style.display === 'block') {
            sec.style.display = 'none';
        } else {
            sec.style.display = 'block';
            // Scroll to history section
            sec.scrollIntoView({behavior: 'smooth', block: 'start'});
        }
    }

    function finishTransaction() {
        closeModals();
        document.getElementById('amtInput').value = ""; // Clear input
        
        // Show success message
        const originalText = document.querySelector('.btn-withdraw').innerHTML;
        document.querySelector('.btn-withdraw').innerHTML = '<i class="fas fa-check"></i> Withdrawal Requested!';
        document.querySelector('.btn-withdraw').style.background = '#34c759';
        
        setTimeout(() => {
            document.querySelector('.btn-withdraw').innerHTML = originalText;
            document.querySelector('.btn-withdraw').style.background = '';
        }, 3000);
    }
</script>
</body>
</html>
